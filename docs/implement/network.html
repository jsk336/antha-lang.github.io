<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Organization">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="RvtWEWrocoYtDU6-Q3NSHTzz4xoBaajomeqfLuNUNn0" />
<meta itemprop="name" content="Antha - The Network Communcations Model of Antha">
<meta itemprop="description" content="Antha is a high level language for describing biological protocols, workflows, and experiments. Antha also provides execution capabilities for both robots or manual processes.">


<meta itemprop="image" content="http://www.antha-lang.org/images/instacod.png">


<title>
  
    The Network Communcations Model of Antha - 
   Antha
</title>
<link rel="shortcut icon" href="/images/logos/a-logo-32.png">
<link href="//fonts.googleapis.com/css?family=RobotoDraft:300,400,500|Source+Code+Pro:400,500,700" rel="stylesheet">


  <link href="/css/site2.css" rel="stylesheet">

<link href="/css/site2_sd_rules.css" rel="stylesheet" shim-shadowdom>



<script src="/js/webcomponents.min.js"></script>
<!-- TODO: remove when https://github.com/Polymer/polymer/issues/391 is fixed -->
<link rel="import" href="/components/polymer/polymer.html">


  <link rel="import" href="/elements/common_elements.vulcanized.html">


</head>
<body id="the-network-communcations-model-of-antha">

<main id="content-container">
  <app-drawer id="sidebar" unresolved>
    <div layout vertical id="sidebar-content">
      <div id="logo-container" layout horizontal center>
        <a href="/" class="logo"><img src="/images/logos/a-logo-color-416.svg" width="242" height="80"></a>
        <core-icon id="dropdown-toggle" icon="arrow-drop-down"></core-icon>
      </div>

      <dropdown-panel>
  <core-item icon="book" label="Start" >
    <a href="/docs/intro.html"></a>
  </core-item>
  <core-item icon="drive-document" label="Docs" active>
    <a href="/docs/index.html"></a>
  </core-item>
  <core-item icon="list" label="Resources" >
    <a href="/resources/faq.html"></a>
  </core-item>
</dropdown-panel>


      <docs-menu unresolved menu="docs" flex></docs-menu>
    </div>
  </app-drawer>

  <scroll-area sidebar unresolved>
    <site-banner type="implement" navgroup="docs" shortname="network" unresolved>
      

<app-bar theme="light" class="bar fixed" unresolved>
  <a href="/docs/intro.html" class="paper-button " borderless sink>Learn</a>
  <a href="/docs/index.html" class="paper-button active" borderless sink>Docs</a>
  <a href="/resources/faq.html" class="paper-button " borderless sink>Resources</a>
</app-bar>

      <header>
        <h1>The Network Communcations Model of Antha</h1>
        
          <summary>How it Works</summary>
        
      </header>
    </site-banner>

    
    

    <article class="show-permalinks">
      <span class="edit-on-github">
  <a href="https://github.com/Synthace/docs/edit/master/docs/implement/network.md">Edit on Github</a>
</span>
<div><!-- intentionally blank --></div>

      <header class="onlyonmobile">
        <h1>The Network Communcations Model of Antha</h1>
        
          <summary>How it Works</summary>
        
      </header>

      
     <details id="toc">
       <summary>Table of contents</summary>
       
<ul id="markdown-toc">
  <li><a href="#define-processes-and-inports">Define processes and inports</a></li>
  <li><a href="#define-functions-which-transform-the-inputs">Define functions which transform the inputs.</a></li>
  <li><a href="#instantiate--new-graph">Instantiate  new graph</a></li>
  <li><a href="#add-the-processes-to-the-graph-and-connect-inports-to-outports">Add the processes to the graph and connect inports to outports.</a></li>
  <li><a href="#open-inport-channels-send-data-to-them-and-close-them-again">Open inport channels, send data to them, and close them again.</a></li>
</ul>

     </details>


<p>Network development is a key component to Flow Based Programming (FBP).  These networks are created in Antha by opening processes and directing channels to them.  The following text describes the syntax needed to do so.</p>

<p>Consider the following script. This program reads names, titles, and occupations and prints greetings based on those inputs.  It does so by creating a network of two processes: one which reads strings and produces greetings, a second which takes those greetings and prints them to the console. This program is a modified version of an example script created by V. Sibirov (https://github.com/trustmaster/goflow)</p>

<pre><code class="language-go">// Example network program using Antha
package main

import (
    "fmt"
    "github.com/Synthace/goflow"
)

type Greeter struct {
    flow.Component               // component "superclass" embedded
    Name           &lt;-chan string // input port
    Title          &lt;-chan string // another input port
    Occupation          &lt;-chan string // another input port
    Res            chan&lt;- string // output port
}

func (g *Greeter) OnName(name string) {
    greeting := fmt.Sprintf("Hello, %s!", name)
    g.Res &lt;- greeting
}

func (g *Greeter) OnTitle(title string) {
    greeting := fmt.Sprintf("I shall call you %s", title)
    g.Res &lt;- greeting
}

func (g *Greeter) OnOccupation(occupation string) {
    greeting := fmt.Sprintf("You are a %s. Very impressive!", occupation)
    g.Res &lt;- greeting
}

type Printer struct {
    flow.Component
    Line &lt;-chan string
}

func (p *Printer) OnLine(line string) {
    fmt.Println(line)
}

type GreetingApp struct {
    flow.Graph
}

func NewGreetingApp() *GreetingApp {
    n := new(GreetingApp)
    n.InitGraphState()

    n.Add(new(Greeter), "greeter")
    n.Add(new(Printer), "printer")

    n.Connect("greeter", "Res", "printer", "Line")

    n.MapInPort("In1", "greeter", "Name")
    n.MapInPort("In2", "greeter", "Title")
    n.MapInPort("In3", "greeter", "Occupation")
    return n
}

func main() {
    net := NewGreetingApp()

    name := make(chan string)
    title := make(chan string)
    occupation := make(chan string)
    net.SetInPort("In1", name)
    net.SetInPort("In2", title)
    net.SetInPort("In3", occupation)

    flow.RunNet(net)

    title &lt;- "Sir"
    name &lt;- "John"
    name &lt;- "Boris"
    title &lt;- "Dame"
    name &lt;- "Hanna"
	occupation &lt;- "doctor"

    close(name)
	close(title)
	close(occupation)

    &lt;-net.Wait()
}
</code></pre>

<p>The output from this script looks like this:<br />
<code>
Hello, John!
I shall call you Sir
I shall call you Dame
Hello, Hanna!
Hello, Boris!
You are a doctor.  Very impressive!
</code></p>

<h2 id="define-processes-and-inports">Define processes and inports</h2>

<p>Every network of processes needs channels which handle inputs and outputs. A channel for inputs is an inport, a channel for outputs is an outport. A channel provides a mechanism for concurrently executing functions to communicate by sending and receiving values of a specified element type. The value of an uninitialized channel is nil. In this example, the processes are “Greeter” and “Printer.” The inports and outports are defined as string channels in each process.</p>

<pre><code class="language-go">type Greeter struct {
    flow.Component               		// component "superclass" embedded
    Name           &lt;-chan string 		// input port
    Title          &lt;-chan string 		// another input port
    Occupation          &lt;-chan string	// another input port
    Res            chan&lt;- string 		// output port
}
</code></pre>

<pre><code class="language-go">type Printer struct {
    flow.Component
    Line &lt;-chan string
}
</code></pre>

<h2 id="define-functions-which-transform-the-inputs">Define functions which transform the inputs.</h2>

<p>Transformations on data are executed via functions which point to the processes defined earlier.</p>

<pre><code class="language-go">func (g *Greeter) OnName(name string) {
    greeting := fmt.Sprintf("Hello, %s!", name)
    g.Res &lt;- greeting
}

func (g *Greeter) OnTitle(title string) {
    greeting := fmt.Sprintf("I shall call you %s", title)
    g.Res &lt;- greeting
}

func (g *Greeter) OnOccupation(occupation string) {
    greeting := fmt.Sprintf("You are a %s. Very impressive!", occupation)
    g.Res &lt;- greeting
}
</code></pre>

<pre><code class="language-go">func (p *Printer) OnLine(line string) {
    fmt.Println(line)
}
</code></pre>

<h2 id="instantiate--new-graph">Instantiate  new graph</h2>

<pre><code class="language-go">type GreetingApp struct {
    flow.Graph
}
</code></pre>

<h2 id="add-the-processes-to-the-graph-and-connect-inports-to-outports">Add the processes to the graph and connect inports to outports.</h2>

<pre><code class="language-go">func NewGreetingApp() *GreetingApp {
    n := new(GreetingApp)
    n.InitGraphState()

    n.Add(new(Greeter), "greeter")
    n.Add(new(Printer), "printer")

    n.Connect("greeter", "Res", "printer", "Line")

    n.MapInPort("In1", "greeter", "Name")
    n.MapInPort("In2", "greeter", "Title")
    n.MapInPort("In3", "greeter", "Occupation")
    return n
}
</code></pre>

<h2 id="open-inport-channels-send-data-to-them-and-close-them-again">Open inport channels, send data to them, and close them again.</h2>

<p>All data must be passed to the inports before closing any channels.</p>

<pre><code class="language-go">func main() {
    net := NewGreetingApp()

    name := make(chan string)
    title := make(chan string)
    occupation := make(chan string)
    net.SetInPort("In1", name)
    net.SetInPort("In2", title)
    net.SetInPort("In3", occupation)

    flow.RunNet(net)

    title &lt;- "Sir"
    name &lt;- "John"
    name &lt;- "Boris"
    title &lt;- "Dame"
    name &lt;- "Hanna"
	occupation &lt;- "doctor"

    close(name)
	close(title)
	close(occupation)

    &lt;-net.Wait()
}
</code></pre>

    </article>

    <footer>
  <div>
    <div class="links">  
	<paper-button raised>
      		<a href="/docs/intro.html">
		<core-icon icon="archive"></core-icon>
		Learn More 
		</a> 
	</paper-button>
	<paper-button>
      		<a href="https://twitter.com/intent/follow?screen_name=anthalang" data-twitter-follow title="Follow @anthalang on Twitter">
			<core-icon icon="social:post-twitter"></core-icon>
			@anthalang
		</a>
	</paper-button>
	<paper-button class="github">
      		<a href="https://github.com/antha-lang">
			<core-icon icon="social:post-github"></core-icon>
				/Antha
		</a>
	</paper-button>
	<paper-button>
      		<a href="https://github.com/antha-lang/antha-lang.github.io/issues/new">
		<core-icon icon="bug-report"></core-icon>
		File a bug
		</a>
	</paper-button>
    </div>
    <p id="copyright">&copy; 2014 Antha Authors. Code licensed under the <a href="http://antha-lang.org/LICENSE.txt" target="_blank">GPL 2.0 License</a>. Documentation licensed under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>. Proudly sponsored by <a href="http://www.synthace.com" target="_blank">Synthace</a></p>
  </div>
</footer>


  
<script>var POLYMER_VERSION = '0.4.2';</script>

<script src="/js/prettify/prettify.js"></script>

<script src="/js/app.js"></script>


  </scroll-area>

</main>

</body>
</html>
